{% extends 'base.html.twig' %}

{% block title %}Actualités{% endblock %}
{% block monTitre %}{{post.title}}{% endblock %}

{% block body %}
    
    <div class="container">
    {% for message in app.flashes('success') %}
        <div class="text-center alert alert-success">
            {{message}}
        </div>
    {% endfor %}

        <section>
            <article class=" mt-2 mb-5"> 
                <p>Publié le : {{post.createAt | date('d/m/Y')}} </p>           
                <img src="{{asset('images/products/' ~ post.image)}}" style="width:40%; height:auto" alt="Image de l'article">
                <div class="h5 mt-5">{{post.content | raw}}</div>
            </article>
        </section>

        <section class="mb-5">
        
            <p class="text-white text-center bg-primary h4 p-2">{{post.comments | length}} commentaires :</p>
              {% for comment in post.comments %}
              <div class="comment">
                  <div class="row">
                      <div class="col-3">
                          {{comment.author}}  (<small>{{comment.createdAt | date
                              ('d/m/Y à H:i')}}</small>)
                             
                      </div>
                      <div class="col-7">
                          {{comment.content | raw }}
                          {{comment.id}}
                       
                      </div>
                      <div class="col-2">
                         
                    <form method="post" class="col" action="{{path('delete_comment',{'id' : comment.id})}}" onsubmit="return confirm('Voulez-vous vraiment supprimer cet article ?')">
                        <input type="hidden" name="_method" value="DEL"> <!--Pour ne oas créer de collision entre les routes -->
                        <input type="hidden" name="_tokencomment" value="{{csrf_token('DEL' ~ comment.id)}}">
                        <input type="submit" class="btn btn-danger w-100" value="supprimer">
                    </form>
                    </div>
                  </div> 
                 
              </div>
           
              {% endfor %}
            <p class="text-white text-center bg-primary h4 p-2">Laissez un commentaire</p>
            {{ form_start(commentForm) }}
            {{ form_row(commentForm.author, {"attr" : {'placeholder':'Entrez votre pseudo'},"label":"Pseudo"})}}
            {{ form_row(commentForm.content, {"attr" : {'placeholder':'Ecrivez votre commentaire'},"label":"Commentaire"})}}
            <button type="submit" class="btn btn-primary">Commenter</button>
            {{form_end(commentForm)}}
        </section>
    </div>
{% endblock %}
